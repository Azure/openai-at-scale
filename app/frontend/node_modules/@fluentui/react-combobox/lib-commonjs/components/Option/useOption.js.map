{"version":3,"sources":["../../../lib/components/Option/useOption.js"],"sourcesContent":["import * as React from 'react';\nimport { getNativeElementProps, resolveShorthand, useId, useMergedRefs } from '@fluentui/react-utilities';\nimport { useContextSelector } from '@fluentui/react-context-selector';\nimport { CheckmarkFilled, Checkmark12Filled } from '@fluentui/react-icons';\nimport { ComboboxContext } from '../../contexts/ComboboxContext';\nimport { ListboxContext } from '../../contexts/ListboxContext';\nfunction getTextString(text, children) {\n  if (text !== undefined) {\n    return text;\n  }\n  let textString = '';\n  let hasNonStringChild = false;\n  React.Children.forEach(children, child => {\n    if (typeof child === 'string') {\n      textString += child;\n    } else {\n      hasNonStringChild = true;\n    }\n  });\n  // warn if an Option has non-string children and no text prop\n  if (hasNonStringChild) {\n    // eslint-disable-next-line no-console\n    console.warn('Provide a `text` prop to Option components when they contain non-string children.');\n  }\n  return textString;\n}\n/**\n * Create the state required to render Option.\n *\n * The returned state can be modified with hooks such as useOptionStyles_unstable,\n * before being passed to renderOption_unstable.\n *\n * @param props - props from this instance of Option\n * @param ref - reference to root HTMLElement of Option\n */\nexport const useOption_unstable = (props, ref) => {\n  const {\n    children,\n    disabled,\n    text,\n    value\n  } = props;\n  const optionRef = React.useRef(null);\n  const optionText = getTextString(text, children);\n  const optionValue = value !== null && value !== void 0 ? value : optionText;\n  // use the id if provided, otherwise use a generated id\n  const id = useId('fluent-option', props.id);\n  // data used for context registration & events\n  const optionData = React.useMemo(() => ({\n    id,\n    disabled,\n    text: optionText,\n    value: optionValue\n  }), [id, disabled, optionText, optionValue]);\n  // context values\n  const focusVisible = useContextSelector(ListboxContext, ctx => ctx.focusVisible);\n  const multiselect = useContextSelector(ListboxContext, ctx => ctx.multiselect);\n  const registerOption = useContextSelector(ListboxContext, ctx => ctx.registerOption);\n  const selected = useContextSelector(ListboxContext, ctx => {\n    const selectedOptions = ctx.selectedOptions;\n    return !!optionValue && !!selectedOptions.find(o => o === optionValue);\n  });\n  const selectOption = useContextSelector(ListboxContext, ctx => ctx.selectOption);\n  const setActiveOption = useContextSelector(ListboxContext, ctx => ctx.setActiveOption);\n  const setOpen = useContextSelector(ComboboxContext, ctx => ctx.setOpen);\n  // current active option?\n  const active = useContextSelector(ListboxContext, ctx => {\n    var _ctx_activeOption, _ctx_activeOption1;\n    return ((_ctx_activeOption = ctx.activeOption) === null || _ctx_activeOption === void 0 ? void 0 : _ctx_activeOption.id) !== undefined && ((_ctx_activeOption1 = ctx.activeOption) === null || _ctx_activeOption1 === void 0 ? void 0 : _ctx_activeOption1.id) === id;\n  });\n  // check icon\n  let CheckIcon = /*#__PURE__*/React.createElement(CheckmarkFilled, null);\n  if (multiselect) {\n    CheckIcon = selected ? /*#__PURE__*/React.createElement(Checkmark12Filled, null) : '';\n  }\n  const onClick = event => {\n    var _props_onClick;\n    if (disabled) {\n      event.preventDefault();\n      return;\n    }\n    // clicked option should always become active option\n    setActiveOption(optionData);\n    // close on option click for single-select options in a combobox\n    if (!multiselect) {\n      setOpen === null || setOpen === void 0 ? void 0 : setOpen(event, false);\n    }\n    // handle selection change\n    selectOption(event, optionData);\n    (_props_onClick = props.onClick) === null || _props_onClick === void 0 ? void 0 : _props_onClick.call(props, event);\n  };\n  // register option data with context\n  React.useEffect(() => {\n    if (id && optionRef.current) {\n      return registerOption(optionData, optionRef.current);\n    }\n  }, [id, optionData, registerOption]);\n  const semanticProps = multiselect ? {\n    role: 'menuitemcheckbox',\n    'aria-checked': selected\n  } : {\n    role: 'option',\n    'aria-selected': selected\n  };\n  return {\n    components: {\n      root: 'div',\n      checkIcon: 'span'\n    },\n    root: getNativeElementProps('div', {\n      ref: useMergedRefs(ref, optionRef),\n      'aria-disabled': disabled ? 'true' : undefined,\n      id,\n      ...semanticProps,\n      ...props,\n      onClick\n    }),\n    checkIcon: resolveShorthand(props.checkIcon, {\n      required: true,\n      defaultProps: {\n        'aria-hidden': 'true',\n        children: CheckIcon\n      }\n    }),\n    active,\n    disabled,\n    focusVisible,\n    multiselect,\n    selected\n  };\n};\n//# sourceMappingURL=useOption.js.map"],"names":["useOption_unstable","getTextString","text","children","undefined","textString","hasNonStringChild","React","Children","forEach","child","console","warn","props","ref","disabled","value","optionRef","useRef","optionText","optionValue","id","useId","optionData","useMemo","focusVisible","useContextSelector","ListboxContext","ctx","multiselect","registerOption","selected","selectedOptions","find","o","selectOption","setActiveOption","setOpen","ComboboxContext","active","_ctx_activeOption","_ctx_activeOption1","activeOption","CheckIcon","createElement","CheckmarkFilled","Checkmark12Filled","onClick","event","_props_onClick","preventDefault","call","useEffect","current","semanticProps","role","components","root","checkIcon","getNativeElementProps","useMergedRefs","resolveShorthand","required","defaultProps"],"mappings":"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"}