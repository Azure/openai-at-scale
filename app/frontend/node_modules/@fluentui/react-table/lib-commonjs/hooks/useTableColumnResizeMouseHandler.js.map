{"version":3,"sources":["../../lib/hooks/useTableColumnResizeMouseHandler.js"],"sourcesContent":["import * as React from 'react';\nimport { useFluent_unstable as useFluent } from '@fluentui/react-shared-contexts';\nimport { getEventClientCoords, isMouseEvent, isTouchEvent } from '@fluentui/react-utilities';\nexport function useTableColumnResizeMouseHandler(columnResizeState) {\n  const mouseX = React.useRef(0);\n  const currentWidth = React.useRef(0);\n  const colId = React.useRef(undefined);\n  const {\n    targetDocument\n  } = useFluent();\n  const globalWin = targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.defaultView;\n  const recalculatePosition = React.useCallback(e => {\n    const {\n      clientX\n    } = getEventClientCoords(e);\n    const dx = clientX - mouseX.current;\n    // Update the local width for the column and set it\n    currentWidth.current += dx;\n    colId.current && columnResizeState.setColumnWidth(e, {\n      columnId: colId.current,\n      width: currentWidth.current\n    });\n    mouseX.current = clientX;\n  }, [columnResizeState]);\n  const onDrag = React.useCallback(e => {\n    // Using requestAnimationFrame here drastically improves resizing experience on slower CPUs\n    if (typeof (globalWin === null || globalWin === void 0 ? void 0 : globalWin.requestAnimationFrame) === 'function') {\n      requestAnimationFrame(() => recalculatePosition(e));\n    } else {\n      recalculatePosition(e);\n    }\n  }, [globalWin === null || globalWin === void 0 ? void 0 : globalWin.requestAnimationFrame, recalculatePosition]);\n  const onDragEnd = React.useCallback(event => {\n    if (isMouseEvent(event)) {\n      targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.removeEventListener('mouseup', onDragEnd);\n      targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.removeEventListener('mousemove', onDrag);\n    }\n    if (isTouchEvent(event)) {\n      targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.removeEventListener('touchend', onDragEnd);\n      targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.removeEventListener('touchmove', onDrag);\n    }\n  }, [onDrag, targetDocument]);\n  const getOnMouseDown = columnId => {\n    return event => {\n      // Keep the width locally so that we decouple the calculation of the next with from rendering.\n      // This makes the whole experience much faster and more precise\n      currentWidth.current = columnResizeState.getColumnWidth(columnId);\n      mouseX.current = getEventClientCoords(event).clientX;\n      colId.current = columnId;\n      if (isMouseEvent(event)) {\n        // ignore other buttons than primary mouse button\n        if (event.target !== event.currentTarget || event.button !== 0) {\n          return;\n        }\n        targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.addEventListener('mouseup', onDragEnd);\n        targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.addEventListener('mousemove', onDrag);\n      }\n      if (isTouchEvent(event)) {\n        targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.addEventListener('touchend', onDragEnd);\n        targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.addEventListener('touchmove', onDrag);\n      }\n    };\n  };\n  return {\n    getOnMouseDown: columnId => getOnMouseDown(columnId)\n  };\n}\n//# sourceMappingURL=useTableColumnResizeMouseHandler.js.map"],"names":["useTableColumnResizeMouseHandler","columnResizeState","mouseX","React","useRef","currentWidth","colId","undefined","targetDocument","useFluent","globalWin","defaultView","recalculatePosition","useCallback","e","clientX","getEventClientCoords","dx","current","setColumnWidth","columnId","width","onDrag","requestAnimationFrame","onDragEnd","event","isMouseEvent","removeEventListener","isTouchEvent","getOnMouseDown","getColumnWidth","target","currentTarget","button","addEventListener"],"mappings":"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"}